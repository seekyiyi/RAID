## RAID
容錯式磁碟陣列（RAID, Redundant Array of Independent Disks）
簡單來說，RAID把多個硬碟組合成為一個邏輯磁區，因此，作業系統只會把它當作一個硬碟。
RAID 有多種建置方式，依照最終設定的不同，有著不一樣的特性。

## 磁碟陣列比較表
![RAID](http://7.blog.xuite.net/7/c/f/f/235965372/blog_3098629/txt/189424118/0.jpg)


# RAID 0 （區塊延展）

RAID 0 利用兩個或多個硬碟共同運作，發揮最大的儲存效能的讀/寫能力。
在 RAID 0 磁碟區排列插入的區塊，在分散磁碟，讀取與寫入的資料可以執行平行處理。
這個 「 區塊延展 」 技術是所有 RAID 等級，特別是讀寫大型的檔案中最快的。
實際工作的 RAID 0 能為的好處，包括在影像編輯軟體，將大量的影片檔儲存於影像編輯軟體，或以 CD/VCD 發行封裝建立 CD 或 VCD 影像中載入大量檔案。

跟單硬碟比起來，RAID 0 的優點包括了：

- 更大的儲存空間 — RAID 0 陣列的容量大於單硬碟，可以儲存更大的資料檔。

- 讀寫效能更佳 — RAID 0 陣列的 I/O 動作，都被平均分配到陣列中的所有硬碟中。（假設所有 I/O 都不是單區塊的資料）

- 不浪費空間 — 所有硬碟上的空間全部用來儲存資料。

跟單硬碟比起來，RAID 0 有以下缺點：

- 較不可靠 — 要讓 RAID 0 運作，陣列中的每個磁碟都要正常工作。在 N 個硬碟的 RAID 0 中，一個硬碟壞掉，損失的是 1/N 的資料，但卻會讓整個陣列無用武之地。

優點：使用 n 顆硬碟，即可擁有將近 n 倍的讀寫效能。
缺點：資料安全性較低，同組陣列中任一硬碟發生問題就會造成資料遺失。
硬碟數量：最少 2 個。

![RAID](http://www.intel.com/content/dam/support/us/en/images/chipsets/imsm/sb/img/raid2.jpg)
[不妨把 RAID 0 想成 0% 的硬碟空間是重複的。]

# RAID 1 （鏡射）
RAID 1 鏡射的主要好處是，它就會提供資料的可靠性，當單一磁碟故障。當一個磁碟故障時，所有資料都會立即可用在其他而不影響任何資料的完整性。萬一磁碟故障，電腦系統仍能保持全力運作，確保最大的生產力。

因為資料可以從-原始版本及鏡射-的多個磁碟機同時讀取，是大於單一磁碟機的 RAID 1 陣列的效能。磁碟寫入無法達到優點，因為資料前會寫入一個硬碟機，然後射到另。

資料寫入 RAID 1 的時候，都會複製成兩份：一份寫到第一顆硬碟，另一份寫到第二顆硬碟。而相反地，讀取資料時，只要從其中一顆硬碟讀取即可。

跟單硬碟比起來，RAID 1 陣列有以下好處：

- 更佳的冗餘可靠性 — 即使陣列裡其中一個硬碟故障，使用者還是可以存取資料。
- 更好的讀取效能 — 從兩個硬碟上分頭讀取資料，可以分擔單硬碟的 I/O 負荷。

跟單硬碟比較起來，RAID 1 有以下缺點：

- 陣列的最大空間，無法超過陣列中最大硬碟的容量。
- 寫入效能變慢 — 因為兩個硬碟都得保持最新的資料，所以每次寫入的時候，兩顆硬碟都得運作，拖慢整個陣列的寫入效能。

成本效益較低 — 因為兩顆硬碟中，只存有一份資料，所以 RAID 1 的成本至少是單硬碟的兩倍。

[不妨把 RAID 1 想成 100% 的硬碟空間是重複的。]

# RAID 5 （採用同位檢查的區塊延展）
RAID 5 試圖結合 RAID 0 與 RAID 1 的優點，但又避免它們的缺點。

跟 RAID 0 一樣，RAID 5 陣列包含了多個硬碟，每個硬碟切成若干區塊。這讓 RAID 5 陣列比其他任何單硬碟都大。跟 RAID 1 類似，RAID 5 陣列使用了部份磁碟空間，儲存多餘的位元組，增加可靠性。

然而，RAID 5 的運作方式卻跟 RAID 0 或 RAID 1 截然不同。

RAID 5 陣列為三個或更多的硬碟，將資料分割為易於管理的區塊，稱為區塊延展。RAID 5 的主要優點包含儲存容量和資料保護。

同位檢查是一種數學方法，將資料遺失的單一磁碟機，因而提高容錯能力，重新建立。資料與同位檢查可以跨越陣列中所有的硬碟機。同位檢查被循環序列，以減少同位檢查計算相關的瓶頸。

RAID 5 陣列的容量是最小磁碟機的大小乘以陣列中的磁碟機的數目比小。相當於一個硬碟機用來儲存同位檢查資訊，以此達到容錯少於 50%的容量降低的 RAID 1。例如，含有 4 部 120 GB 硬碟的 RAID 5 陣列看起來像個 360 GB 硬碟，在作業系統中。

跟單硬碟比起來，RAID 5 陣列有以下優點：

- 更佳的冗餘可靠性 — 如果陣列中其中一顆硬碟壞掉，陣列還是可以繼續運作，同時藉由同位檢查資訊，可以重建壞掉的區塊。
- 更佳的讀取效能 — 由於 RAID 0 型態的儲存方式使然，資料分散在陣列中的硬碟，讀取的 I/O 活動也同樣平均分散到所有硬碟上。
- 合理的成本效益 — 以擁有 n 顆硬碟的 RAID 5 陣列來說，只有 1/n 的空間被浪費掉。

跟單硬碟比起來，RAID 5 陣列擁有以下缺點：

- 寫入效能較低 — 因為每次寫入資料時，最少需要用到兩顆硬碟（一顆負責寫入資料，另一顆寫入同位檢查碼），所以 RAID 5 的寫入效能比單硬碟來得低。

## 複合式 RAID

從我們之前的討論中，很明顯可以看出每種 RAID 都有其優點與缺點。就在開始使用 RAID 後不久，人們開始想著，可不可以把不同等級的 RAID 組合起來，結合多方的優點，但避免所有的缺點呢？

舉例來說，RAID 0 陣列裡的硬碟，實際上是幾個 RAID 1 陣列，那有什麼好處呢？這方式會讓您享受 RAID 0 的速度，又有 RAID 1 的可靠性。

而這只是例子之一。其他常見的複合式 RAID 有：

RAID 1+0

RAID 5+0

RAID 5+1

因為複合式 RAID 只在專業領域內出現，所以我們在此不詳細討論。然而，在討論複合式 RAID 時，有兩點要注意：

順序不同，意義不同：RAID 等級中的數字，會對可靠度造成相當程度的影響。舉例來說，RAID 1+0 跟 RAID 0+1 就「不」相同。

高成本：如果要找出所有複合式 RAID 的共同缺點，那一定是成本。舉例來說，RAID 5+1 至少需要六顆硬碟（陣列愈大，需要的硬碟還會更多）。

## 混合RAID
# JBOD（ Just a Bunch Of Disks）
JBOD並不是RAID的等級。由於並沒有規範，市場上有兩類主流的做法。

1. 使用單獨的連結埠如SATA、USB或1394同時控制多個各別獨立的硬碟，使用這種模式通常是較高階的裝置，還具備有RAID的功能，不需要依靠JBOD達到合併邏輯磁區的目的。
2. 只是將多個硬碟空間合併成一個大的邏輯硬碟，沒有錯誤備援機制。

![RAID](https://upload.wikimedia.org/wikipedia/commons/thumb/e/e2/JBOD.svg/750px-JBOD.svg.png)

資料的存放機制是由第一顆硬碟開始依序往後存放，即作業系統看到的是一個大硬碟（由許多小硬碟組成的）。但如果硬碟損毀，則該顆硬碟上的所有資料將無法救回。

若第一顆硬碟損壞，通常無法作救援（因為大部分檔案系統將磁碟分割表（partition table）存在磁碟前端，即第一顆），失去磁碟分割表即失去一切資料，若遭遇磁碟陣列資料或硬碟出錯的狀況，危險程度較RAID 0更劇。它的好處是不會像RAID，每次存取都要讀寫全部硬碟。但在部分的JBOD資料恢復實踐中，可以恢復未損毀之硬碟上的資料。同時，因為每次讀寫操作只作用於單一硬碟，JBOD的傳輸速率與I/O表現均與單顆硬碟無異。

## 實作 RAID
至少要能做到以下事情

將 I/O 需求分散到陣列中的所有硬碟

- RAID 5 需要計算同位檢查資訊，並寫到相對應的硬碟裡
- 監測陣列中的硬碟；當硬碟壞掉時，採取適當的應對措施
- 當修復或替換了壞掉的硬碟後，開始重建陣列的過程
- 提供管理者維護硬碟的方法（移除或新增硬碟、開始或終止重建過程等等）
